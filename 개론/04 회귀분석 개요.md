# 회귀분석 개요

대표적인 상태를 토대로 미래의 어떤 결과를 예측하는 분석

## #01. 회귀분석(Regression analysis)의 이해

### 1. 회귀분석의 의미

하나나 그 이상의 독립변수들이 종속변수에 미치는 영향을 추정할 수 있는 통계기법

규명된 함수식을 이용하여 설명변수들의 변화로부터 종속변수의 변화를 예측하는 분석

독립변수 X(설명변수)에 대하여 종속변수 Y(반응변수)들 사이의 관계를 **수학적 모형**을 이용하여 규명하는 것.

💡 $y = f(x)$ 일 때, 함수 $f$ 를 규명하여 독립적인 값 $x$에 따라 $y$가 어떻게 변화하는지를 예측하는 것

변수들 사이의 인과관계를 밝히고 모형을 적합하여 관심있는 변수를 예측하거나 추론하기 위한 분석방법이다.

### 2. 회귀분석의 변수

#### 영향을 받는 변수 (y)

반응변수 (response variable), 종속변수 (dependent variable), 결과변수(outcome variable)

#### 영향을 주는 변수 (X)

설명변수 (explanatory variable), 독립변수 (independent variable), 예측변수 (predictor variable)

## #02. 회귀분석 예시

### 키에 따른 몸무게

![img](res/ols.png)

$Weight = a + b \times Height$

| 변수 | 내용 |
|---|---|
| Weight | Height에 따라 결정되므로 종속변수 |
| Height | Weight를 결정하는 요인이 되므로 독립변수 |
| b | 기울기 (선의 경사도)<br/> 기울기 크기가 클수록 선이 더 경사지고 변화율이 더 커진다. |
| a | 절편 (선과 y축이 교차하는 위치) |

## #03. 회귀분석의 가정

통계학에서의 회귀 분석은 전제 조건이 생각보다 까다로운 편이며 사실 이 전제 조건들이 참이어야만 회귀 분석을 통해 얻은 결괏값과 의미가 비로소 참이라고 할 수 있다.

- 종속변수의 값은 정규성(정규 분포)을 지녀야 한다.
- 독립변수 간에는 다중 공선성이 존재하지 않아야 한다.
- 선형 회귀 분석의 경우 독립변수와 종속변수 간의 선형성이 보장되어야 한다.
- 오차항은 독립변수의 값과 관계없이 동일한 분산을 갖는다(등분산성).

이런 전제조건이 만족한지 아닌지는 회귀 분석으로 추정된 회귀식을 만들고 난뒤 여러 가지 회귀 분석 적합성 검정을 통해 확인할 수 있다.

| 조건 | 설명 |
|---|---|
| 선형성 | 종속과 독립변수의 관계가 선형이다. (선형회귀분석에서 가장 중요한 가정) |
| 잔차의 정규성 | 오차의 분포가 정규분포를 따른다.<br/>Q-Q plot, Shaprio-Wilk 검정 Kolmogolov-Smirnov 검정 등을 활용하여 정규성을 확인 |
| 잔차의 등분산성 | 오차의 분산이 입력변수와 무관하게 일정하다. Breusch-Pagan test |
| 잔차의 독립성 | 입력변수와 오차는 관련이 없다.<br/>자기상관 (독립성)을 알아보기 위해 Durbin-Waston 통계량을 사용 |

## #04. 회귀분석 종류

![img](res/ols_type.png)

## #05. 회귀분석의 검정

### 1) 예측변수(회귀계수)들이 유의미한가 ?

- 각 독립변수($x$)의 회귀계수($b$)가 유의한가?
- t-검정을 사용
- 해당 계수의 t 통계량의 p-값이 0.05 보다 작으면 해당 회귀계수가 통계적으로 유의하다고 볼 수 있다.

### 2) 모형이 얼마나 설명력을 갖는가 ?

- 만들어진 회귀모형(예측모형)이 유의한가?
- 주어진 모든 변수들이 함께 어느 정도 예측변수의 변량을 설명(예측)하는가?
- 결정계수 ($R^2$)를 확인한다 . 결정계수는 0~1 값을 가지며，높은 값을 가질수록 추정된 회귀식의 설명력이 높다 .

### 3) 모형이 데이터를 잘 적합하고 있는가 ?

- 잔차를 그래프로 그리고 회귀진단을 한다.


## #06. Sklearn이 제공하는 회귀 모형

- 선형 회귀 (Linear Regression)
- 릿지 회귀 (Ridge Regression)
- 라쏘 회귀 (Lasso Regression)
- 엘라스틱 넷 회귀 (Elastic Net Regression)
- 베이지안 릿지 회귀 (Bayesian Ridge Regression)
- 서포트 벡터 머신 회귀 (Support Vector Machine Regression)
- 의사결정트리 회귀 (Decision Tree Regression)
- 랜덤 포레스트 회귀 (Random Forest Regression)
- Ada 부스트 회귀 (AdaBoost Regression)
- 그래디언트 부스팅 회귀 (Gradient Boosting Regression)

> 제공되는 모든 모형에 대한 코드를 작성하고 결과를 비교하여 가장 좋은 결과를 만들어내는 모형을 채택해야 한다.

## 선형회귀 Kaggle 데이터 셋

### [1] 월마트 판매

주요 소매업체의 매출에 영향을 미칠 수 있는 요소 찾기

https://www.kaggle.com/datasets/mikhail1681/walmart-sales

### [2] 중고차 가격 데이터세트

중고차 가격 예측을 위한 데이터 세트

https://www.kaggle.com/datasets/rishabhkarn/used-car-dataset

